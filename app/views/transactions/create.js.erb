<% publish_to @path do %>
  var boardId = <%= @new_transaction.board.id %>;
  var id = 'transactions_content_' + boardId;

  var newTDate = new Date('<%= @new_transaction.get_transaction_year %>-<%= @new_transaction.get_transaction_month %>-<%= @new_transaction.get_transaction_day %>');
  var refDate = new Date('1970-01-01');
  var tCount = <%= @current_board.transactions.count %>;
  console.log(tCount);
  console.log(newTDate);
  console.log(refDate);
  if (tCount == 1) {
    $('#'+id).append("<%= j render(@new_transaction) %>");
  } else {
    for (var i = tCount; i > 0; i--) {
      console.log(i);
      var currentTDateTxt = $('.transaction:nth-child(' + i + ') .transaction_date').text();
      console.log(currentTDateTxt);
      if ( !currentTDateTxt ) {
        console.log('date = rien');
        currentTDateTxt = '9999-12-31'
      }
      var currentTDate = new Date(currentTDateTxt);
      console.log(currentTDate);
      console.log(newTDate);
      if (newTDate >= currentTDate) {
        console.log('new plus vieux que analys√©')
        if (i == tCount) {
          $('#'+id).append("<%= j render(@new_transaction) %>");
          break;
        }
        $('.transaction:nth-child(' + i + ')').after("<%= j render(@new_transaction) %>");
        break;
      }
      if (i == 1) {
        $('#'+id).prepend("<%= j render(@new_transaction) %>");
        break;
      }
    }
  }
<% end %>
