<h3><%= @current_board.title %></h3>

<div id="board_<%= @current_board.id %>_users">
  <% if @current_board.accounts.any? %>
    <%= render @current_board.accounts %>
  <% end %>
</div>

<%= simple_form_for [@current_board, @new_account], method: :post, remote: true do |f| %>
  <%= f.input :user %>
  <%= f.button :submit, "Give access" %>
<% end %>

<%= simple_form_for [@current_board, @new_friend], method: :post, remote: true do |f| %>
  <%= f.input :name %>
  <%= f.button :submit, "Add friend" %>
<% end %>

<div id="transactions_content_<%= @current_board.id %>">
  <% if @current_board.transactions.any? %>
    <%= render @current_board.transactions.order(:date, :created_at) %>
  <% end %>
</div>

<% int, dec = @current_board.board_sum %>
<div id="transactions_sum_<%= @current_board.id %>"><%= int %>, <%= dec %></div>
<% int, dec, bit = @current_board.average_expenses %>
<div id="average_for_<%= @current_board.id %>"><span id="real_for_<%= @current_board.id %>"><%= int %>, <%= dec %></span><span id="bit_for_<%= @current_board.id %>"><%= bit %></span></div>


<%= simple_form_for [@current_board, @new_transaction], method: :post, remote: true do |f| %>
  <%= f.input :payer, collection: @current_board.friends %>
  <%= f.input :amountint, input_html: { min: '0'} %>
  <%= f.input :amountdec, input_html: { maxlength: 2, min: '0', max: '99'  } %>
  <%= f.input :date, as: :string, include_blank: :true, input_html: { class: "datepicker" } %>
  <%= f.input :comment %>
  <%= f.button :submit, "Add" %>
<% end %>

<ul>
  <% @current_board.credits.order(:date, :created_at).each do |credit| %>
    <li>
      <%= credit.creditor.name %> lend <%= credit.amount %> to <%= credit.debtor.name %>
      <%= credit.date if credit.date %>
      <%= credit.comment if credit.comment %>
    </li>
  <% end %>
</ul>

<%= simple_form_for [@current_board, @new_credit], method: :post, remote: true do |f| %>
  <%= f.input :creditor, collection: @current_board.friends %>
  <%= f.input :amountint, input_html: { min: '0'} %>
  <%= f.input :amountdec, input_html: { maxlength: 2, min: '0', max: '99' } %>
  <%= f.input :debtor, collection: @current_board.friends %>
  <%= f.input :date, as: :string, include_blank: :true, input_html: { class: "datepicker" } %>
  <%= f.input :comment %>
  <%= f.button :submit, "Add" %>
<% end %>

<div id="board_<%= @current_board.id %>_friends">
  <% if @current_board.friends.any? %>
    <%= render @current_board.friends %>
  <% end %>
</div>

<%= subscribe_to @path %>
